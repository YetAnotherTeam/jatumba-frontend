<div class="col xl2 l3 m3 s3 col-menu">

    <div class="card silver">
        <div class="card-content">
            <div class="card-header">
                <span class="card-title activator grey-text text-darken-4">
                    Инструменты
                    <!--<i class="material-icons right">keyboard_arrow_up</i>-->
                </span>

            </div>
    <!--<a class="mdl-navigation__link"
       *ngFor="#instrument of instrumentList"
       [ngClass]="{
           'mdl-navigation__link--current': instrument.active
       }"
       "
       [attr.data-instrument-id]="instrument.id"
    >{{instrument.name}}</a>
    <br/>
    <button class="btn btn-success" (click)="createTrack()" *ngIf="isEditorMode">Создать дорожку</button>
    -->
            <ul class="collection no-margin silver collection__special">
                <li class="collection-item"
                    *ngFor="#instrument of instrumentList"
                    [ngClass]="{
                        'collection-item_active': instrument.active
                    }">
                    <div class="collection-item__icon">
                        <i class="material-icons">queue_music</i>
                    </div>
                    <div class="collection-item__name" (click)="changeActiveInstrument(instrument)"
                         [attr.data-instrument-id]="instrument.id">
                        <div class="collection-item__title">
                            <span class="link">{{instrument.name}}</span>
                        </div>
                    </div>
                    <div class="collection-item__secondary double">
                        <i class="material-icons clickable" (click)="createTrack()" *ngIf="isEditorMode">add</i>
                    </div>
                </li>


                <!--<li class="collection-item">-->
                    <!--<div class="collection-item__icon">-->
                        <!--<i class="material-icons">queue_music</i>-->
                    <!--</div>-->
                    <!--<div class="collection-item__name">-->
                        <!--<div class="collection-item__title">-->
                            <!--<a href="#" class="link">Drums Drums</a>-->
                        <!--</div>-->
                        <!--<div class="comment">Изменено там что-то</div>-->
                        <!--<div class="comment">2 часа назад</div>-->
                    <!--</div>-->
                    <!--<div class="collection-item__secondary">-->
                        <!--<i class="material-icons">check</i>-->
                    <!--</div>-->
                <!--</li>-->
                <!--<li class="collection-item">-->
                    <!--<div class="collection-item__icon">-->
                        <!--<i class="material-icons">queue_music</i>-->
                    <!--</div>-->
                    <!--<div class="collection-item__name">-->
                        <!--<div class="collection-item__title">Drums</div>-->
                    <!--</div>-->
                    <!--<div class="collection-item__secondary double">-->
                        <!--<i class="material-icons">content_copy</i>-->
                        <!--<i class="material-icons">more_vert</i>-->
                    <!--</div>-->
                <!--</li>-->
            </ul>
        </div>
    </div>

    <div class="card silver">
        <div class="card-content">
            <div class="card-header">
                <span class="card-title activator grey-text text-darken-4">Commits</span>

            </div>
            <ul class="collection no-margin silver collection__special">
                <li *ngFor="#commit of commits" class="collection-item">
                    <div class="collection-item__icon">
                        <span class="avatar">
                            <img [src]="commit.author.avatar ? commit.author.avatar : '/img/default_avatar.jpg'">
                        </span>
                    </div>
                    <div class="collection-item__name">
                        <div class="collection-item__title">{{commit.author.username}}</div>
                        <div class="comment">commited {{timeSince(commit.create_datetime)}}</div>
                    </div>
                    <div class="collection-item__secondary">
                        <i (click)="showCommit(commit)" class="material-icons clickable">restore</i>
                    </div>
                </li>
            </ul>
        </div>
    </div>




</div>
<div class="col xl10 l9 m9 s9 col-board">

    <div class="card silver" style="min-height: 495px;">
        <div style="position: absolute; top: 250px; left: 200px;" *ngIf="!trackList.length">В данный момент композиция пуста! Попробуйте добавить музыкальную дорожку!</div>
        <div class="card-content">
            <div class="card-header">
                <div class="playboard-header">
                    <div class="playboard-header__left" *ngIf="activeInstrument && composition">
                        <template [ngIf]="trackList.length">
                            <span class="play" *ngIf="!isPlay" (click)="play()">
                                <i class="material-icons">play_circle_filled</i>
                            </span>
                            <span class="play" *ngIf="isPlay" (click)="stop()" style="color: black;">
                                <i class="material-icons">stop</i>
                            </span>
                        </template>
                        <span class="bpm">
                            <span class="bpm__title">BPM</span>
                            <span class="bpm__beat"><input type="text" class="inp-underlined" value="120" [(ngModel)]="bpm"></span>
                        </span>

                        <div class="icon-add" *ngIf="isEditorMode">
                            <span class="step" *ngFor="#sound of activeInstrument.sounds">
                                <span class="icon circle"
                                      [ngClass]="{
                                            'selected': sound.active
                                        }"
                                      (click)="changeActiveSound(sound.name)"
                                      [class]="mappingSoundNameToType(sound.name)"
                                ></span>
                            </span>
                        </div>
                    </div>

                    <div class="playboard-header__right">
                            <span *ngIf="isEditorMode" class="topbar_icon">
                                <i (click)="revertComposition()" class="material-icons clickable">settings_backup_restore</i>
                            </span>
                            <span *ngIf="isEditorMode" class="topbar_icon">
                                <i (click)="commitComposition()" class="material-icons clickable">done</i>
                            </span>
                            <!--<span class="sound">-->
                                <!--<i class="material-icons clickable">volume_up</i>-->
                            <!--</span>-->
                            <span class="edit link link-grey" (click)="changeEditorMode(!isEditorMode)">
                                Режим редактирования
                            </span>
                        <div class="switch">
                            <label *ngIf="havePermissionToEdit">
                                <input type="checkbox" [checked]="isEditorMode" (change)="changeEditorMode(!isEditorMode)">
                                <span class="lever"></span>
                            </label>
                        </div>
                    </div>
                </div>
            </div>

            <div class="playboard">
                <div class="playboard__container">
                    <div class="playboard__inner">

                        <div class="playboard-track"
                             *ngFor="#track of trackList; #trackIndex = index"
                             [ngClass]="{
                                'active': track.instrument == activeInstrument
                             }"
                        >
                            <div class="playboard-track__info"
                                 [attr.alt]="track.instrument.name"
                                 (click)="changeActiveInstrument(track.instrument)"
                                 [attr.data-instrument-id]="track.instrument.id">
                                <div class="track-brd"
                                     [ngClass]="{
                                            'active': track.instrument == activeInstrument
                                        }">
                                    <div class="playboard-track__avatar">
                                        <div class="avatar"><img src="img/default_avatar.jpg"></div>
                                    </div>
                                    <div class="playboard-track__ruler" style="position: relative;">
                                        <div class="name"><span class="link">{{track.instrument.name}}</span></div>
                                        <span class="rotate45" style="position: absolute; right: 0; top: 0;"
                                             *ngIf="isEditorMode"
                                            (click)="removeTrackByIndex(trackIndex)">
                                            <i class="material-icons clickable">add</i>
                                        </span>
                                        <div class="volume">
                                            <input type="range" [(ngModel)]="track.volume"
                                                   (change)="volumeChange(track)">
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="playboard-track__track">
                                <div class="track">
                                    <div class="track__segment"
                                         *ngFor="#sector of track.sectorList; #sectorIndex = index">
                                        <div class="track__block"
                                             *ngFor="#block of [4,8,12,16,20,24,28,32]"
                                            [attr.data-num]="block % 8 == 0 ? block / 8 : ''">
                                            <div class="track-brd">
                                                <!--Баг ангуляра, костыль-->
                                                <template ngFor #sound [ngForOf]="sector.soundList" #soundIndex="index">
                                                    <span
                                                          (click)="addSound(track,sectorIndex, soundIndex)"
                                                          (contextmenu)="removeSound($event, track, sectorIndex, soundIndex)"
                                                          [class]="mappingSoundNameToType(sound.name)"
                                                          *ngIf="soundIndex < block && soundIndex >= block - 4"
                                                    ></span>
                                                </template>

                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="playhead" [style.transform]="linePosition" style="left:180px;"></div>
                    </div>
                </div>
                <div class="playboard__ruler" *ngIf="isEditorMode && trackList.length">
                    <i class="material-icons clickable" (click)="addSector()">add_circle</i>
                    <i class="material-icons clickable"
                       *ngIf="trackList[0]?.sectorList?.length > 1 && isEditorMode"
                       (click)="removeSector()">remove_circle</i>
                </div>
            </div>

        </div>
    </div>
</div>